<html>

<head>
    <style>
        #image {
            height: 70px;
            width: 48px;
            background: url('sprites.png') 0px 0px no-repeat;
            position: absolute;
            left: 500px;
            top: 300px;
        }

        #input {
            display: block;
        }
        body{
            background: url('https://www.maps.com/media/catalog/product/cache/1/thumbnail/17f82f742ffe127f42dca9de82fb58b1/m/d/mdc1_wor_asia.jpg')
        }
    </style>
</head>

<body id="body">
    <div id="demo">
        <input type="text" id="input">
        <div id="image"></div>
    </div>
    <script>

        document.getElementById('input').focus();
        
        //movement of map, not character.
        let left;
        let right;
        let up;
        let down;

        let state = 'down';
        let rightTO;
        let right2TO;
        let leftTO;
        let left2TO;
        let downTO;
        let down2TO;
        let upTO;
        let up2TO;

        let x = 0;
        let y = 0;

        let xTO;
        
        function walk(event) {
            document.getElementById('input').removeEventListener('keydown', walk);
            
            if (event.keyCode === 39) {
                right();
                moveMapLeft()
                state = 'right';
             
            } if (event.keyCode === 37) {
                left();
                state = 'left';
            
            } if (event.keyCode === 38) {
                up();
                state = 'up';
           
            } if (event.keyCode === 40) {
                down();
                state = 'down';
            }
        }
        function stopWalking(event) {
            clearTimeout(rightTO);
            clearTimeout(right2TO);
            clearTimeout(leftTO);
            clearTimeout(left2TO);
            clearTimeout(downTO);
            clearTimeout(down2TO);
            clearTimeout(upTO);
            clearTimeout(up2TO);
            clearTimeout(xTO);
            
            left = false;

            document.getElementById('input').addEventListener('keydown', walk);
              
              if  (state === 'up') {
                document.getElementById('image').style.backgroundPosition = "0px -67px";
           
            } if (state === 'right') {
                document.getElementById('image').style.backgroundPosition = "-86px 0px";
           
            } if (state === 'down') {
                document.getElementById('image').style.backgroundPosition = "0px 0px";
           
            } if (state === 'left') {
                document.getElementById('image').style.backgroundPosition = "-86px -67px";
            }

        }
        
        function right(){
            document.getElementById('image').style.backgroundPosition = "-86px 0px";
                rightTO = setTimeout(right2, 180);
        }
        function right2(){
                document.getElementById('image').style.backgroundPosition = "-126px 0px";
                right2TO = setTimeout(right, 180);
        }
        function left(){
                document.getElementById('image').style.backgroundPosition = "-86px -67px";
                leftTO = setTimeout(left2, 180)

        }
        function left2(){
            document.getElementById('image').style.backgroundPosition = "-126px -67px";
            left2TO = setTimeout(left, 180)
        }
        function down(){
            document.getElementById('image').style.backgroundPosition = "0px 0px";
            downTO = setTimeout(down2, 180);
        }
        function down2(){
            document.getElementById('image').style.backgroundPosition = "-43px 0px";
            down2TO = setTimeout(down, 180)
        }
        function up(){
            document.getElementById('image').style.backgroundPosition = "0px -67px";
            upTO = setTimeout(up2, 180);
        }
        function up2(){
            document.getElementById('image').style.backgroundPosition = "-43px -67px";
            up2TO = setTimeout(up, 180)
        }
        function moveMap(){
            document.getElementById('body').style.backgroundPosition = `${x}px, ${y}px`;
        }
        function moveMapLeft() {
            moveMap();
            decreaseX();
            left = true
        }
        function moveMapUp(){
            moveMap()
            decreaseY();
        }
        function decreaseX() {
            x--
            if (left) {
                xTO = setTimeout(moveMapLeft, 5)
            }
        }
        function decreaseY(){
            
        }
        document.getElementById('input').addEventListener('keydown', walk);
        document.getElementById('input').addEventListener('keyup', stopWalking);

    </script>
</body>

</html>